## Extra: AAA
- Authentication 인증: 유저를 식별, 사용자의 신원 검증
- Authorization 인가: 인증된 사용자에 대한 특정 권한과 서비스의 부여
- Accounting 계정 관리: 인가가 이루어진 후 사용자가 행한 행위의 기록. 사용 정보를 통해 과금/감사/용량증설/리포팅의 수행
[[인증과 인가]]
## 사용자와 그룹
### 사용자

### 그룹
- uid: 사용자를 표시하는 숫자
- gid: 그룹을 표시하는 숫자
- `/etc/group`: 그룹 정보
- `/etc/passwd`: 사용자 정보, 암호는 x로 표시되어 있고 별도로 `/etc/shadow`에
	- 형식: `username:pw:uid:gid:gecos:homedir:shell`
	- `pw`: `/etc/shadow` 파일에서 관리
	- `gecos`: General Electric Comprehensive Operating System(과거 Unix와의 호환성을 위해 있는 값 ~~없는 셈 치자~~)
	- `shell`
		- nologin이라면 시스템상 필요한 계정이지만 사용자 로그인 용이 아님.
		- 로그인을 막고 싶다면 shell을 `/bin/false`로.
### 명령어
- `usermod`: 사용자 정보 수정
- `groupmod`: 그룹 정보 수정
## 리눅스 권한
10 자리, 첫 자리는 파일/디렉터리인지 판별하고 나머지 자리는 각각 유저/그룹/기타의 r(읽기)w(쓰기-변경, 삭제)x(실행) 권한을 나타낸다. `ls -al`로 조회할 수 있다.
- `-rwxrwxrwx`: 파일이고, 유저/그룹/기타 모두 읽고 쓰고 실행할 수 있다.
- `drwx------`: 디렉터리이고 유저만 읽고 쓰고 실행할 수 있다.
### 숫자 표기
권한의 숫자표기는 각 9 자리를 2 진수로 나타내지만 3 자리씩 끊어 10 진수로 만들어 표시하기도 한다.
```
000 → 0
001 → 1 : 첫 번째 자리, 실행
010 → 2 : 두 번째 자리, 쓰기
011 → 3
100 → 4 : 세 번째 자리, 읽기
101 → 5
110 → 6
111 → 7
```
따라서 `rwxr-x---`은 750으로 표기한다.
### 권한 변경
#### 상대 모드
- 현재 권한을 기준으로 권한을 제거하거나 부여하는 방식
- `+`: 권한 부여 / `-`: 권한 제거 /` =`: 대입 연산자
- `u`: 사용자 / `g`: 해당 그룹의 멤버들 / `o`: 다른 사람 / `a`: 모두
- `S`: 사용자와 그룹만 실행
##### 예시
`chmod g-w aaa`: aaa 파일에서 그룹의 쓰기 권한을 제거
`chmod a+x aaa`: aaa 파일에서 모두 실행 권한 부여
#### 절대 모드
- 권한의 숫자 표기법을 이용하여 권한을 표기
- 기존 부여된 권한은 무시되며 새롭게 지정된 권한으로 재설정한다.
`chmod 530 aaa`: aaa파일에 사용자는 5(= 4+1, 읽기/쓰기), 그룹은 3(= 2+1, 쓰기/실행), 다른 사람들은 권한 없도록 권한을 설정한다.
#### 특수 권한
<figure style="width: 85%" class="align-center">
  <img src="https://onedrive.live.com/embed?resid=C4F97B3B64AE3E7A%217081&authkey=%21AKGq6U4DSg4kSHY&width=418&height=240" alt="">
  <figcaption>특수 권한</figcaption>
</figure>
- 특수 권한을 절대적으로 표기하면 가장 첫번째 오는 4 번째 자리를 차지하며, Set-UID(4), Set-GID(2), Sticky bit(1)를 모두 설정하면 7이다. 
- symbolic method로 표기하면 -rwSrwSrwT 로 표기한다.
- 특수 권한의 해제는 반드시 symbolic method로만 가능하다(Numerical method로는 불가함): `chmod u-s aaa`
- Set-GID나 Set-UID는 umask에 영향받지 않는다.
##### umask
- 새로 생성되는 파일/디렉터리 권한을 제한하는 명령어이다.
- 유저마다 적용시키고, 이는 시스템 관리자 혹은 사용자 스스로 부여한다.
- 기본적으로 0022로 설정되어 있다.
- 세자리 10 진수로 표시되는 권한을 마스킹하여 파일/디렉터리 권한을 제한한다.
- 디렉터리는 777의 기본 권한을 가지고, 파일은 666의 기본 권한을 가진다.
- `umask` 명령어를 사용하면 현재 설정된 umask 값을 출력한다.
###### 예시
- `umask 022`: 새로 생성된 파일의 기본 권한을 644, 생성된 디렉터리의 기본 권한을 755로 설정한다.
- `.bashrc`나 `.profile`파일에 umask값을 추가할 수 있다(`umask 002`라고 입). 이 경우, 모든 새 쉘이서 umask 값이 적용된다.
##### Set-UID
Set-UID가 있으면, 이 프로세스를 실행할 때 파일 소유자의 권한을 실행하는 사용자에게 일시적으로 부여한다. 디렉터리에 붙어 있으면 소유자의 권한을 디렉터리 접근자에게 부여한다.
- 절대적인 방법으로는 세자리 권한 숫자 앞에 4를 붙여 준다. `chmod 4644 [파일 이름]`.
- 상대적인 방법으로는 `chmod u+s [파일명]`
###### 예시
```
kopo13@kopo13:~$ ls -l /usr/bin/passwd
-rwsr-xr-x 1 root root 59976 Feb  6 12:54 /usr/bin/passwd
```
s: 특수 권한을 부여, Set-UID로 설정되어 실행 시 일시적으로 root 권한으로 실행하도록 되어있다.
##### Set-GID
Set-GID가 있으면, 이 프로세스를 실행할 때 파일 소유자의 권한을 실행하는 그룹에게 일시적으로 부여한다. 디렉터리에 붙어 있으면 소유자의 권한을 그룹원에게 부여한다.
- 세자리 권한 숫자 앞에 2를 붙여 부여한다. `chmod 2445 [파일 이름]`.
- 상대적인 방법으로는 `chmod g+s [파일명]`
- Set-GID가 지정된 디렉터리에서 그룹원이 생성한 파일이나 디렉터리의 소유는 그룹원이 된다.
##### Sticky bit
- 디렉터리에 붙어야 작동한다.
	- 누구나 파일 생성 가능: 쓰기 권한이 없는 사용자도 만들 수 있음. 해당 파일의 소유자는 그 파일을 쓴 사용자가 된다.
	- 파일 삭제 제한: 자신이 만든 파일 또는 디렉터리 소유자인 경우만 가능하다.
	- 디렉터리 내 파일의 소유자가 변경될 수 있다.
- 절대적인 방법으로는 세자리 권한 숫자 앞에 1을 붙여준다. `chmod 1777 [파일 이름]`
- 상대적인 방법으로는 `chmod o+t [파일명]`
- **기존 권한에 실행 권한이 없으면 T, 있으면 t로 표시된다.**
#### 예시
- `chown`/`chgrp`: root계정에서만 가능하다.
- `ls`의 `--color`옵션은 파일 유형에 따라 다른 색을 표시한다.
	- **검정색:** 일반 파일
	- **파란색:** 디렉토리
	- **녹색:** 실행 파일
	- **빨간색:** 심볼릭 링크
	- **보라색:** 소켓
	- **갈색:** 장치 파일
	- **회색:** 기타 파일
