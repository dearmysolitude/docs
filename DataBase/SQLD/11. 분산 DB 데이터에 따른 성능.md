---
subject: 데이터 모델링의 이해
chapter: 2장 데이터 모델과 성능
---
## 분산 DB
분산된 DB를 하나의 가상 시스템으로 사용할 수 있도록 한 DB, 물리적 위치는 분산되어 있으나 논리적으로 동일하게 취급하는 시스템. 과거에는 위치 중심이었으나 현재는 필요에 따라 분산 설계한다.
### 설계 방식
- 상향식: 지역 스키마 작성 후 전역 스키마 작성
- 하향식: 전역 스키마 작성 후 지역 사상 스키마 작성
### 장단점
#### 장점
- 신뢰성 및 가용성 증가
- 빠른 응답 속도와 통신 비용 절감
- 용량 확장 용이
#### 단점
- 관리 및 통제 어려움
- 데이터 무결성 관리 어려움
- S/W 개발 비용 및 처리 비용 증가
- 불규칙한 응답 속도
## 투명성
분산 데이터베이스는 여러 컴퓨터 시스템에 데이터를 분산하여 저장하는 시스템이다. 사용자에게는 단일 시스템처럼 보이도록 하는 것이 중요하며, 이를 위해 6 가지 투명성 개념이 도입되었다.
여기서 투명성은 많이 사용되는 의미인 '내부 동작을 명확하게 확인할 수 있다'는 의미가 아니라, '투명하여 인지할 수 없다'는 의미로 사용되었다.

1. 분할 투명성(Fragmentation Transparency)
	하나의 논리적 테이블이 여러 개의 단편으로 분할되어 여러 사이트에 저장되어 있어도 사용자는 이를 인식하지 못한다. 사용자는 이 투명성을 가지는 분할 DB를 단일 테이블처럼 쿼리를 실행하고 결과를 얻을 수 있다.
2. 위치 투명성(Location Transparency)
	데이터가 어느 사이트에 저장되어 있는지 사용자가 알 필요 없이 데이터에 접근할 수 있다. 사용자는 쿼리에서 데이터 위치를 명시할 필요 없이 원하는 데이터를 얻을 수 있다.
3. 지역사상 투명성(Locality Transparency)
	사용자는 데이터가 어느 사이트에 저장되어 있는지 알 수 없지만, 자신의 사이트에 가까운 위치에 있는 데이터에 우선적으로 접근할 수 있다. 이는 네트워크 지연 시간을 줄여 성능을 향상시키는 데 도움이 된다.
4. 중복 투명성(Replication Transparency)
	데이터가 여러 사이트에 복제되어 저장되어 있어도 사용자는 이를 인식하지 못한다. 사용자는 데이터가 항상 사용가능하다는 것을 보장받는다.
5. 장애 투명성(Failure Transparency)
	하나 또는 여러 사이트에서 장애가 발생하여도 사용자는 이를 인식하지 못하고 작업을 계속할 수 있다. 시스템은 자동으로 장애를 복구하고 데이터 접근성을 유지한다.
6. 병행 투명성(Concurrency Transparancy)
	여러 사용자가 동시에 데이터에 접근하고 작업해도 서로 간섭하지 않고 작업을 완료할 수 있다. 시스템은 트랜잭션 처리 기법을 사용하여 데이터 무결성을 유지한다.
### 중요성
각 투명성은 분산 데이터베이스 시스템의 사용 편의성, 성능, 안정성을 향상시키는데 중요한 역할을 한다.
- 분할 투명성, 위치 투명성, 지역사상 투명성: 데이터 접근성을 향상시키고 사용자에게 편리한 사용 환경을 제공한다.
- 중복 투명성: 데이터 손실 위험을 줄이고 시스템 안정성을 높인다.
- 장애 투명성: 시슽메 장애에도 불구하고 서비스 연속성을 유지한다.
- 병행 투명성: 여러 사용자의 동시 접근에도 데이터 무결성을 유지하고 성능 저하를 방지한다.
### 다중 버전 동시성 제어
다중 버전 동시성 제어(Multiversion Concurrency Control, MVCC)는 분산 데이터베이스에서 트랜잭션 처리를 위한 병행 처리 기법이다. 트랜잭션 간 충돌 가능성을 감지하고 해결하기 위해 여러 버전의 데이터를 유지하며, 사용자에게 투명한 방식으로 트랜잭션 실행 환경을 제공한다.
#### 특징
- 다중 버전: 여러 버전의 데이터를 유지한다.
- 낙관적 잠금: 트랜잭션은 시작 전에 데이터를 잠그지 않는다.
- 충돌 감지: 트랜잭션 종료 시 다른 트랜잭션과 충돌 여부를 확인한다.
- 충돌 해결: 충돌이 발생하면 시스템은 충돌을 해결한다.
#### 작동 방식
1. 트랜잭션이 시작될 때, 시스템은 해당 트랜잭션을 위한 새로운 버전의 데이터를 생성한다.
2. 읽기 작업을 수행할 때, 가장 최신 버전의 데이터를 읽는다.
3. 쓰기 작업을 수행할 때, 새 버전의 데이터에 변경 사항을 적용한다.
4. 트랜잭션이 종료될 때, 시스템은 새 버전의 데이터를 영구 저장소에 저장한다.
5. 다른 트랜잭션이 동일한 데이터에 접근하려고 하면, 시스템은 두 트랜잭션의 버전을 비교하여 충돌 여부를 확인한다.
6. 충돌이 발생하면 시스템은 충돌을 해결한다.
#### 장점
- 높은 성능
- 높은 확장성
- 높은 가용성: 충돌 가능성이 낮기 때문에 높은 가용성을 제공한다.
#### 단점
- 높은 메모리 사용
- 높은 CPU 사용량
#### 언제 적용하는가
- 높은 성능과 확장성이 필요한 경우
- 가용성, 즉 한번에 받을 수 있는 트랜잭션이 높아야 하는 경우
## 분산 DB 구현
- 테이블 위치 분산: 설계된 테이블의 위치를 분산한다.
- 테이블 분할 분산(Table Fragmentation): 테이블을 쪼개어 분산한다, 수평/수직 분할
- 테이블 복제 분산(Table Replication): 동일한 테이블을 다른 지역이나 서버에서 동시에 생성하고 원격지 조인을 내부 조인으로 변경하여 성능을 향상시킨다: 부분 복제 / 광역 복제
- 테이블 요약 분산(Table Summarization)
	- 분석 요약: 사이트별 요약 정보를 본사에서 통합하여 전체 요약정보를 산출한다.
	- 통합 요약: 사이트별 정보를 본사에서 통합하여 전체 요약정보를 산출한다.

## 참고자료
https://mangkyu.tistory.com/53