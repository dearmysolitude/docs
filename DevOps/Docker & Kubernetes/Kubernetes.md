## 요약
- master - worker node(pod(container와 비슷)가 생성됨)로 구성
- master는 pod를 자동 생성을 관리함.
- master는 Restful API 로 worker에 명령을 주고 받는다.
- Minikube: Kubernetes의 가벼운 구현체, 학습에 최적화 됨.
- Kubernetes 를 실행해보면 container가 들어있고, 다양한 kubernetes의 서비스들이 docker 형태로 돌아가고 있는 것을 확인할 수 있다.
- Kubernetes에서는 **label**을 통해 pod를 구별한다.

## Pod
## Replicaset

## Deploy
- Rolling deploy / Rollbakc이 손쉽게 가능함.

## Service
**Kubernetes의 서비스 → 네트워크**, deploy한 image들에 대한 네트워크 구조를 서비스라는 이름으로 deploy할 수 있다.
- CluseterIP 타입
- NodePort 타입
- Loadbalancer 타입

## ClusterIP 타입


### 서비스의 외부 연결
- 오버레이 네트워크: 기존 7계층 네트워크와는 다른 내부 네트워크 구조를 가지고 있음. 마스터가 네트워크에 대한 맵을 관리함: 
1. 프록시: 내부 클러스터 IP 의 존재를 알고 있기 때문에 외부로 연결이 가능한 것. 프록시로 요청이 오면 프로시가 내부 IP로 요청함.
2. 포트포워딩: 클러스터 IP를 통해 연결되는 것이 아님... 아마 외부에서 접속할 수 있도록 고정 포트를 할당. 외부에서는 내부 체계를 모르므로 하나로 고정되면 바뀌지 않는다.
### 프록시와 포트포워딩

> [!Note] 프록시와 포트포워딩 - Claude AI
> 1. 서비스를 통한 접근 (프록시 방식):
 >   - 서비스는 여러 포드에 대한 로드 밸런싱을 제공합니다.
   > - 각 요청마다 서비스의 로드 밸런서가 사용 가능한 포드 중 하나를 선택합니다.
   > - 따라서 연속된 요청이 서로 다른 포드로 라우팅될 수 있습니다.
   > - 이는 트래픽 분산과 고가용성을 위한 것입니다.
> 2. 포트 포워딩:
   > - `kubectl port-forward` 명령은 특정 포드나 서비스에 직접적인 연결을 만듭니다.
   > - 포트 포워딩이 서비스를 대상으로 할 경우, 연결이 생성될 때 하나의 포드가 선택됩니다.
   > - 이 연결은 포트 포워딩 세션이 유지되는 동안 같은 포드로 유지됩니다.
   > - 새로운 요청이 들어와도 처음 선택된 포드로 계속 전달됩니다.
>
> 포트 포워딩의 특성:
>1. 연결 유지: 포트 포워딩 세션이 활성화되어 있는 동안 같은 포드와의 연결이 유지됩니다.
>2. 세션 종료 전까지 고정: 포드가 삭제되거나 포트 포워딩 세션이 종료되기 전까지는 대상 포드가 변경되지 않습니다.
>3. 디버깅에 유용: 특정 포드의 동작을 지속적으로 관찰하거나 디버깅할 때 유용합니다.
>
>주의사항:
> - 포트 포워딩 중 대상 포드가 삭제되면 연결이 끊어집니다.
> - 새로운 포트 포워딩 세션을 시작하면 다른 포드가 선택될 수 있습니다.
> 이러한 특성 때문에 포트 포워딩은 주로 개발, 테스트, 디버깅 목적으로 사용되며, 프로덕션 환경에서의 로드 밸런싱이나 고가용성 목적으로는 적합하지 않습니다.
> 실제 운영 환경에서는 서비스를 통한 접근이 더 적절하며, 이는 자동으로 로드 밸런싱과 장애 복구를 제공합니다.


> [!Question] 프록시가 로드밸런싱을 지원하지만 외부 서비스의 로드 밸런서를 사용하는 이유
> 1. 외부 트래픽 관리:
 >   - 쿠버네티스 프록시는 주로 클러스터 내부 트래픽을 관리합니다.
 >   - 외부 로드밸런서는 클러스터 외부에서 들어오는 트래픽을 효과적으로 관리하고 분산시킵니다.
> 2. 보안:
 >   - 외부 로드밸런서는 추가적인 보안 계층을 제공합니다 (예: DDoS 방어, WAF 등).
 >   - 클러스터로 직접 들어오는 트래픽을 필터링하고 제어할 수 있습니다.
>3. SSL/TLS 종료:
 >   - 많은 외부 로드밸런서는 SSL/TLS 종료를 효율적으로 처리할 수 있습니다.
 >   - 이는 클러스터 내부 리소스의 부하를 줄여줍니다.
>4. 고급 라우팅 기능:
 >   - 외부 로드밸런서는 종종 더 복잡한 라우팅 규칙, 리다이렉션, URL 기반 라우팅 등을 제공합니다.
>5. 확장성:
 >   - 대규모 트래픽을 처리할 때 외부 로드밸런서가 더 효과적일 수 있습니다.
 >   - 클라우드 제공업체의 로드밸런서는 자동 스케일링을 지원하는 경우가 많습니다.
>6. 클라우드 네이티브 통합:
 >   - 클라우드 환경에서 제공하는 로드밸런서는 해당 클라우드의 다른 서비스들과 잘 통합됩니다.
>7. 헬스 체크와 장애 감지:
>    - 외부 로드밸런서는 종종 더 강력한 헬스 체크 메커니즘을 제공합니다.
>8. 글로벌 로드밸런싱:
 >   - 일부 외부 로드밸런서 서비스는 지리적으로 분산된 트래픽을 처리할 수 있습니다.
>9. 관리 용이성:
>    - 네트워크 팀이 외부 로드밸런서를 더 쉽게 관리하고 모니터링할 수 있습니다.
>10. 레거시 시스템 통합:
 >   - 기존 인프라와의 통합이 필요한 경우, 외부 로드밸런서가 더 적합할 수 있습니다.
>
> 결론적으로, 쿠버네티스의 내부 프록시와 외부 로드밸런서는 서로 다른 목적과 장점을 가지고 있어, 많은 경우 둘을 함께 사용하여 최적의 성능과 관리 효율성을 달성합니다. 특정 상황과 요구사항에 따라 적절한 조합을 선택하는 것이 중요합니다.

## NodePort 타입
개발 용이를 위해 사용되는 타입